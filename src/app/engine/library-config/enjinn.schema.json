{
  "$schema": "http://json-schema.org/draft-07/schema",
  "type": "object",
  "properties": {
    "smartPlaylists": {
      "type": "array",
      "items": { "$ref": "#/definitions/SmartPlaylist" }
    }
  },
  "definitions": {
    "SmartPlaylist": {
      "type": "object",
      "properties": {
        "name": { "type": "string" },
        "sources": {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1
        },
        "rules": { "$ref": "#/definitions/PlaylistRuleGroup" }
      },
      "required": ["name", "rules"]
    },
    "PlaylistRuleGroup": {
      "type": "object",
      "oneOf": [
        {
          "properties": {
            "and": {
              "type": "array",
              "items": { "$ref": "#/definitions/PlaylistRuleNode" }
            }
          },
          "required": ["and"]
        },
        {
          "properties": {
            "or": {
              "type": "array",
              "items": { "$ref": "#/definitions/PlaylistRuleNode" }
            }
          },
          "required": ["or"]
        }
      ]
    },
    "PlaylistRuleNode": {
      "oneOf": [
        { "$ref": "#/definitions/PlaylistRule" },
        { "$ref": "#/definitions/PlaylistRuleGroup" }
      ]
    },
    "PlaylistRule": {
      "oneOf": [
        { "$ref": "#/definitions/StringPlaylistRule" },
        { "$ref": "#/definitions/NumericPlaylistRule" }
      ]
    },
    "StringPlaylistRule": {
      "type": "object",
      "properties": {
        "field": { "$ref": "#/definitions/StringFilterField" },
        "operator": { "$ref": "#/definitions/StringFilterOperator" },
        "value": { "type": "string" },
        "caseSensitive": {
          "type": "boolean",
          "default": false
        }
      },
      "required": ["field", "operator", "value"]
    },
    "NumericPlaylistRule": {
      "type": "object",
      "properties": {
        "field": { "$ref": "#/definitions/NumericFilterField" },
        "operator": { "$ref": "#/definitions/NumericFilterOperator" },
        "value": { "type": "number" }
      },
      "required": ["field", "operator", "value"]
    },
    "StringFilterField": {
      "type": "string",
      "enum": [
        "album",
        "artist",
        "comment",
        "composer",
        "filename",
        "fileType",
        "genre",
        "label",
        "path",
        "remixer",
        "title"
      ]
    },
    "StringFilterOperator": {
      "type": "string",
      "enum": ["equals", "notequal", "contains", "excludes", "regex"]
    },
    "NumericFilterField": {
      "type": "string",
      "enum": ["bitrate", "bpm", "length", "rating", "year"]
    },
    "NumericFilterOperator": {
      "type": "string",
      "enum": ["=", "!=", ">", ">=", "<", "<="]
    }
  },
  "additionalProperties": false
}
